name: Add another (experimental)
description: |
  The "add another" component lets users input multiple values for a set of form
  fields.
body: |
  This component is currently experimental because more research is needed to
  validate it.
  
  Applications using this component must include a deletion checkbox in addtion
  to the rendered repeating items as well as an empty field. The checkboxes and
  empty field are required to allow users without javascript to add new items
  and remove existing items from the list. See the examples below for how to do
  this.

  The example here passes HTML in to the component due to limitations in the
  format of this documentation. In applications it is expected that the caller
  will render other components instead. See Whitehall for
  [examples of this approach](https://github.com/alphagov/whitehall/pull/9644).

accessibility_criteria: |
  The form controls within the fieldsets must be fully accessible as per the
  design system guidance for each of the form control components.
uses_component_wrapper_helper: true
govuk_frontend_components:
  - button
examples:
  default:
    data:
      fieldset_legend: "Person"
      add_button_text: "Add another person"
      items:
        - fields: >
            <div class="govuk-form-group">
              <label for="person_0_name" class="gem-c-label govuk-label">Full name</label>
              <input class="gem-c-input govuk-input" id="person_0_name" name="person[0]name">
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="person[0][_destroy]" id="person_0__destroy" class="govuk-checkboxes__input">
                <label for="person_0__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
      empty:
        <div class="govuk-form-group">
          <label for="person_1_name" class="gem-c-label govuk-label">Full name</label>
          <input class="gem-c-input govuk-input" id="person_1_name" name="person[1]name">
        </div>
  without_ga4_tracking:
    description: |
      Disables GA4 tracking on the add another component. Tracking is enabled by default. This adds a data module and data-attributes with JSONs to the add another component buttons. See the [ga4-event-tracker documentation](https://github.com/alphagov/govuk_publishing_components/blob/main/docs/analytics-ga4/ga4-event-tracker.md) for more information.
    data:
      fieldset_legend: "Item"
      add_button_text: "Add another item"
      disable_ga4: true
      items:
        - fields: >
            <div class="govuk-form-group">
              <label for="item_0_name" class="gem-c-label govuk-label">Full name</label>
              <input class="gem-c-input govuk-input" id="item_0_name" name="item[0]name">
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="item[0][_destroy]" id="item_0__destroy" class="govuk-checkboxes__input">
                <label for="item_0__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
      empty:
        <div class="govuk-form-group">
          <label for="item_1_name" class="gem-c-label govuk-label">Full name</label>
          <input class="gem-c-input govuk-input" id="item_1_name" name="item[1]name">
        </div>        
  start_empty:
    description: By default no form fields are displayed when the component loads if no content is specified
    data:
      fieldset_legend: "Employee"
      add_button_text: "Add an employee"
      empty_fields: true
      items: null
      empty:
        <div class="govuk-form-group">
          <label for="employee_1_name" class="gem-c-label govuk-label">Full name</label>
          <input class="gem-c-input govuk-input" id="employee_1_name" name="employee[1]name">
        </div>

  with_select_with_search:
    description: Add another with a select with search input
    data:
      fieldset_legend: "Organisation"
      add_button_text: "Add another organisation"
      items:
        - fields: >
            <div class="govuk-form-group">
              <label for="organisations_1">Select Organisation 1</label>
              <select name="organisations[0][id]" id="organisations_1" class="govuk-select" data-module="select-with-search" tabindex="-1">
                <option value="" selected="">Select one</option>
                <option value="4dfe21ee-acfa-4fc1-9513-cc764e814205" selected="selected">Academy for Justice Commissioning</option>
                <option value="b854f170-53c8-4098-bf77-e8ef42f93107">Academy for Social Justice</option>
                <option value="ce357bdb-6396-426a-9f1f-8cbfb444cffd">Academy for Social Justice Commissioning</option>
                <option value="a0f338c5-e94c-42f8-9c26-b9c2eb6850d3">Accelerated Access Review</option>
                <option value="92bbe2da-8d5f-480b-8da1-50b18e317654">Accelerated Capability Environment</option>
              </select>
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="organisations[0][_destroy]" id="organisation_0__destroy" class="govuk-checkboxes__input">
                <label for="organisation_0__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
      empty:
        <div class="govuk-form-group">
          <label for="organisations_2">Select Organisation 2</label>
          <select name="organisations[1][id]" id="organisations_2" class="govuk-select" tabindex="-1" data-module="select-with-search">
          <option value="" selected="">Select one</option>
          <option value="4dfe21ee-acfa-4fc1-9513-cc764e814205">Academy for Justice Commissioning</option>
          <option value="b854f170-53c8-4098-bf77-e8ef42f93107">Academy for Social Justice</option>
          <option value="ce357bdb-6396-426a-9f1f-8cbfb444cffd">Academy for Social Justice Commissioning</option>
          <option value="a0f338c5-e94c-42f8-9c26-b9c2eb6850d3">Accelerated Access Review</option>
          <option value="92bbe2da-8d5f-480b-8da1-50b18e317654">Accelerated Capability Environment</option>
          </select>
        <div class="govuk-form-group">

  with_conditional_checkbox:
    description: Add another with a conditional checkbox.
    data:
      fieldset_legend: "Person"
      add_button_text: "Add another person"
      items:
        - fields: >
            <div class="govuk-form-group">
              <label for="item_0_name" class="gem-c-label govuk-label">Full name</label>
              <input class="gem-c-input govuk-input" id="item_0_name" name="item[0]name">
            </div>
            <div data-module="gem-checkboxes govuk-checkboxes" class="gem-c-checkboxes govuk-form-group">
               <fieldset class="govuk-fieldset">
                  <legend class="govuk-fieldset__legend govuk-fieldset__legend--m govuk-fieldset__legend--hidden">Add email?</legend>
                  <div class="govuk-checkboxes" data-module="govuk-checkboxes">
                     <div class="govuk-checkboxes__item">
                        <input type="checkbox" name="item[0][add_email]" id="item_0_add_email" value="true" class="govuk-checkboxes__input" data-aria-controls="item_0_add_email-conditional-0" />
                        <label for="item_0_add_email" class="govuk-label govuk-checkboxes__label">Add email?</label>
                     </div>
                     <div id="item_0_add_email-conditional-0" class="govuk-checkboxes__conditional govuk-checkboxes__conditional--hidden">
                        <div class="govuk-form-group">
                          <label class="govuk-label" for="item_0_email">Email address</label>
                          <input class="govuk-input govuk-!-width-one-third" id="item_0_email" name="item[0][email]" type="email">
                        </div>
                     </div>
                  </div>
               </fieldset>
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="item[0][_destroy]" id="item_0__destroy" class="govuk-checkboxes__input">
                <label for="item_0__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
      empty: >
        <div class="govuk-form-group">
           <label for="item_1_name" class="gem-c-label govuk-label">Full name</label>
           <input class="gem-c-input govuk-input" id="item_1_name" name="item[1]name">
         </div>
         <div data-module="gem-checkboxes govuk-checkboxes" class="gem-c-checkboxes govuk-form-group">
            <fieldset class="govuk-fieldset">
               <legend class="govuk-fieldset__legend govuk-fieldset__legend--m govuk-fieldset__legend--hidden">Add email?</legend>
               <div class="govuk-checkboxes" data-module="govuk-checkboxes">
                  <div class="govuk-checkboxes__item">
                     <input type="checkbox" name="item[1][add_email]" id="item_1_add_email" value="true" class="govuk-checkboxes__input" data-aria-controls="item_1_add_email-conditional-0" />
                     <label for="item_1_add_email" class="govuk-label govuk-checkboxes__label">Add email?</label>
                  </div>
                  <div id="item_1_add_email-conditional-0" class="govuk-checkboxes__conditional govuk-checkboxes__conditional--hidden">
                     <div class="govuk-form-group">
                       <label class="govuk-label" for="item_1_email">Email address</label>
                       <input class="govuk-input govuk-!-width-one-third" id="item_1_email" name="item[1][email]" type="email">
                     </div>
                  </div>
               </div>
            </fieldset>
         </div>
  

  sortable:
    description: | 
      Adding `sortable` to the component will allow users to rearrange the items in the list.
      
      This component uses SortableJS. When JavaScript is disabled a set of inputs will be shown allowing users to 
      provide an order index for each item.
      
      For this to work, each field must have an `order_index` input provided.
    data:
      fieldset_legend: "Person"
      add_button_text: "Add another person"
      sortable: true
      items:
        - fields: >
            <div class="govuk-form-group">
              <label for="sortable_person_0_name" class="gem-c-label govuk-label">Full name</label>
              <input class="gem-c-input govuk-input" id="sortable_person_0_name" name="person[0]name" value="Person A">
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="person[0][_destroy]" id="sortable_person_0__destroy" class="govuk-checkboxes__input">
                <label for="sortable_person_0__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
          order_input: >
            <input class="gem-c-input govuk-input govuk-input--width-2" id="sortable_person_0_order" name="person[0]order" value="1">
        - fields: >
            <div class="govuk-form-group">
              <label for="sortable_person_1_name" class="gem-c-label govuk-label">Full name</label>
              <input class="gem-c-input govuk-input" id="sortable_person_1_name" name="person[1]name" value="Person B">
            </div>
          destroy_checkbox: >
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input type="checkbox" name="person[1][_destroy]" id="sortable_person_1__destroy" class="govuk-checkboxes__input">
                <label for="sortable_person_1__destroy" class="govuk-label govuk-checkboxes__label">Delete</label>
              </div>
            </div>
          order_input: >
            <input class="gem-c-input govuk-input govuk-input--width-2" id="sortable_person_1_order" name="person[1]order" value="2">
      empty:
        <div class="govuk-form-group">
          <label for="sortable_person_2_name" class="gem-c-label govuk-label">Full name</label>
          <input class="gem-c-input govuk-input" id="sortable_person_2_name" name="person[2]name">
        </div>
