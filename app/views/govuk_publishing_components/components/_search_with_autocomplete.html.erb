<%
  add_gem_component_stylesheet("search-with-autocomplete")
  add_gem_component_stylesheet("label")

  source = local_assigns[:source]
  source_key = local_assigns[:source_key]

  if source.nil? || source_key.nil?
    raise ArgumentError, "The search_with_autocomplete component requires source and source_key"
  end

  search_component_options = local_assigns.except(:autocomplete, :source, :source_key).merge(
    # The `search` component has an inline label by default, but this conflicts with the accessible-
    # autocomplete component's markup and styling. Every potential use of this component is in
    # situations where we want the label not to be inline anyway, so we override the default here.
    inline_label: false
  )
%>
<%= tag.div(
  class: "gem-c-search-with-autocomplete",
  data: { module: "search-with-autocomplete", source:, source_key: }
) do %>
  <%= render "govuk_publishing_components/components/search", search_component_options %>
<% end %>
