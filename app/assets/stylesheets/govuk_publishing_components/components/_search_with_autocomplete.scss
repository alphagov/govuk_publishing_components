@import "govuk_publishing_components/individual_component_support";

// These styles are adapted from the original Accessibile Autocomplete component stylesheet, mostly
// to remove superfluous styles that are already provided by the GOV.UK Design System, and to adapt
// the styling to match the designs (e.g. to remove the zebra striping on rows).
//
// see https://github.com/alphagov/accessible-autocomplete/blob/main/src/autocomplete.css

// TODO: These are duplicated from _search.scss. Should we move them to a shared place?
$input-size: 40px;
$large-input-size: 50px;

.gem-c-search-with-autocomplete {
  .autocomplete__wrapper {
    position: relative;
  }

  .autocomplete__menu {
    background-color: govuk-colour("white");
    border: 1px solid $govuk-border-colour;
    border-top: 0;
    margin: 0;
    max-height: 342px;
    overflow-x: hidden;
    padding: 0;

    // Make the autocomplete menu as wide as the entire search box _including_ the submit button,
    // not just the width of the input field.
    margin-right: -$input-size;
    .gem-c-search-large & {
      margin-right: -$large-input-size;
    }
  }

  .autocomplete__menu--visible {
    display: block;
  }

  .autocomplete__menu--hidden {
    display: none;
  }

  .autocomplete__menu--overlay {
    box-shadow: rgba(0, 0, 0, 0.256863) 0px 2px 6px;
    left: 0;
    position: absolute;
    top: 100%;
    z-index: 100;
  }

  .autocomplete__menu--inline {
    position: relative;
  }

  .autocomplete__option {
    @include govuk-font(19);
    padding: 5px;
    border-bottom: solid $govuk-border-colour;
    border-width: 1px 0;
    cursor: pointer;
    display: block;
  }

  .autocomplete__option > * {
    pointer-events: none;
  }

  .autocomplete__option:first-of-type {
    border-top-width: 0;
  }

  .autocomplete__option:last-of-type {
    border-bottom-width: 0;
  }

  .autocomplete__option--focused,
  .autocomplete__option:hover {
    background-color: $govuk-link-colour;
    border-color: $govuk-link-colour;
    color: govuk-colour("white");
    outline: none;
  }

  @media (forced-colors: active) {
    .autocomplete__menu {
      border-color: FieldText;
    }

    .autocomplete__option {
      background-color: Field;
      color: FieldText;
    }

    .autocomplete__option--focused,
    .autocomplete__option:hover {
      forced-color-adjust: none; /* prevent backplate from obscuring text */
      background-color: Highlight;
      border-color: Highlight;
      color: HighlightText;

      /* Prefer SelectedItem / SelectedItemText in browsers that support it */
      background-color: SelectedItem;
      border-color: SelectedItem;
      color: SelectedItemText;
      outline-color: SelectedItemText;
    }
  }
}
