{"version":3,"file":"skip-link.mjs","sources":["../../../../src/govuk/components/skip-link/skip-link.mjs"],"sourcesContent":["import { getFragmentFromUrl } from '../../common/index.mjs'\nimport { ElementError } from '../../errors/index.mjs'\nimport { GOVUKFrontendComponent } from '../../govuk-frontend-component.mjs'\n\n/**\n * Skip link component\n *\n * @preserve\n */\nexport class SkipLink extends GOVUKFrontendComponent {\n  /** @private */\n  $module\n\n  /** @private */\n  $linkedElement\n\n  /** @private */\n  linkedElementListener = false\n\n  /**\n   * @param {Element | null} $module - HTML element to use for skip link\n   * @throws {ElementError} when $module is not set or the wrong type\n   * @throws {ElementError} when $module.hash does not contain a hash\n   * @throws {ElementError} when the linked element is missing or the wrong type\n   */\n  constructor($module) {\n    super()\n\n    if (!($module instanceof HTMLAnchorElement)) {\n      throw new ElementError({\n        componentName: 'Skip link',\n        element: $module,\n        expectedType: 'HTMLAnchorElement',\n        identifier: 'Root element (`$module`)'\n      })\n    }\n\n    this.$module = $module\n    this.$linkedElement = this.getLinkedElement()\n\n    this.$module.addEventListener('click', () => this.focusLinkedElement())\n  }\n\n  /**\n   * Get linked element\n   *\n   * @private\n   * @returns {HTMLElement} $linkedElement - Target of the skip link\n   */\n  getLinkedElement() {\n    const linkedElementId = getFragmentFromUrl(this.$module.hash)\n\n    // Check for link hash fragment\n    if (!linkedElementId) {\n      throw new ElementError(\n        'Skip link: Root element (`$module`) attribute (`href`) has no URL fragment'\n      )\n    }\n\n    const $linkedElement = document.getElementById(linkedElementId)\n\n    // Check for link target element\n    if (!$linkedElement) {\n      throw new ElementError({\n        componentName: 'Skip link',\n        element: $linkedElement,\n        identifier: `Target content (\\`id=\"${linkedElementId}\"\\`)`\n      })\n    }\n\n    return $linkedElement\n  }\n\n  /**\n   * Focus the linked element\n   *\n   * Set tabindex and helper CSS class. Set listener to remove them on blur.\n   *\n   * @private\n   */\n  focusLinkedElement() {\n    if (!this.$linkedElement.getAttribute('tabindex')) {\n      // Set the element tabindex to -1 so it can be focused with JavaScript.\n      this.$linkedElement.setAttribute('tabindex', '-1')\n      this.$linkedElement.classList.add('govuk-skip-link-focused-element')\n\n      // Add listener for blur on the focused element (unless the listener has\n      // previously been added)\n      if (!this.linkedElementListener) {\n        this.$linkedElement.addEventListener('blur', () =>\n          this.removeFocusProperties()\n        )\n        this.linkedElementListener = true\n      }\n    }\n\n    this.$linkedElement.focus()\n  }\n\n  /**\n   * Remove the tabindex that makes the linked element focusable because the\n   * element only needs to be focusable until it has received programmatic focus\n   * and a screen reader has announced it.\n   *\n   * Remove the CSS class that removes the native focus styles.\n   *\n   * @private\n   */\n  removeFocusProperties() {\n    this.$linkedElement.removeAttribute('tabindex')\n    this.$linkedElement.classList.remove('govuk-skip-link-focused-element')\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'govuk-skip-link'\n}\n"],"names":["SkipLink","GOVUKFrontendComponent","constructor","$module","$linkedElement","linkedElementListener","HTMLAnchorElement","ElementError","componentName","element","expectedType","identifier","getLinkedElement","addEventListener","focusLinkedElement","linkedElementId","getFragmentFromUrl","hash","document","getElementById","getAttribute","setAttribute","classList","add","removeFocusProperties","focus","removeAttribute","remove","moduleName"],"mappings":";;;;AAIA;AACA;AACA;AACA;AACA;AACO,MAAMA,QAAQ,SAASC,sBAAsB,CAAC;AAUnD;AACF;AACA;AACA;AACA;AACA;EACEC,WAAWA,CAACC,OAAO,EAAE;AACnB,IAAA,KAAK,EAAE,CAAA;AAAA,IAAA,IAAA,CAfTA,OAAO,GAAA,KAAA,CAAA,CAAA;AAAA,IAAA,IAAA,CAGPC,cAAc,GAAA,KAAA,CAAA,CAAA;IAAA,IAGdC,CAAAA,qBAAqB,GAAG,KAAK,CAAA;AAW3B,IAAA,IAAI,EAAEF,OAAO,YAAYG,iBAAiB,CAAC,EAAE;MAC3C,MAAM,IAAIC,YAAY,CAAC;AACrBC,QAAAA,aAAa,EAAE,WAAW;AAC1BC,QAAAA,OAAO,EAAEN,OAAO;AAChBO,QAAAA,YAAY,EAAE,mBAAmB;AACjCC,QAAAA,UAAU,EAAE,0BAAA;AACd,OAAC,CAAC,CAAA;AACJ,KAAA;IAEA,IAAI,CAACR,OAAO,GAAGA,OAAO,CAAA;AACtB,IAAA,IAAI,CAACC,cAAc,GAAG,IAAI,CAACQ,gBAAgB,EAAE,CAAA;AAE7C,IAAA,IAAI,CAACT,OAAO,CAACU,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAACC,kBAAkB,EAAE,CAAC,CAAA;AACzE,GAAA;AAQAF,EAAAA,gBAAgBA,GAAG;IACjB,MAAMG,eAAe,GAAGC,kBAAkB,CAAC,IAAI,CAACb,OAAO,CAACc,IAAI,CAAC,CAAA;IAG7D,IAAI,CAACF,eAAe,EAAE;AACpB,MAAA,MAAM,IAAIR,YAAY,CACpB,4EACF,CAAC,CAAA;AACH,KAAA;AAEA,IAAA,MAAMH,cAAc,GAAGc,QAAQ,CAACC,cAAc,CAACJ,eAAe,CAAC,CAAA;IAG/D,IAAI,CAACX,cAAc,EAAE;MACnB,MAAM,IAAIG,YAAY,CAAC;AACrBC,QAAAA,aAAa,EAAE,WAAW;AAC1BC,QAAAA,OAAO,EAAEL,cAAc;QACvBO,UAAU,EAAG,yBAAwBI,eAAgB,CAAA,IAAA,CAAA;AACvD,OAAC,CAAC,CAAA;AACJ,KAAA;AAEA,IAAA,OAAOX,cAAc,CAAA;AACvB,GAAA;AASAU,EAAAA,kBAAkBA,GAAG;IACnB,IAAI,CAAC,IAAI,CAACV,cAAc,CAACgB,YAAY,CAAC,UAAU,CAAC,EAAE;MAEjD,IAAI,CAAChB,cAAc,CAACiB,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAA;MAClD,IAAI,CAACjB,cAAc,CAACkB,SAAS,CAACC,GAAG,CAAC,iCAAiC,CAAC,CAAA;AAIpE,MAAA,IAAI,CAAC,IAAI,CAAClB,qBAAqB,EAAE;AAC/B,QAAA,IAAI,CAACD,cAAc,CAACS,gBAAgB,CAAC,MAAM,EAAE,MAC3C,IAAI,CAACW,qBAAqB,EAC5B,CAAC,CAAA;QACD,IAAI,CAACnB,qBAAqB,GAAG,IAAI,CAAA;AACnC,OAAA;AACF,KAAA;AAEA,IAAA,IAAI,CAACD,cAAc,CAACqB,KAAK,EAAE,CAAA;AAC7B,GAAA;AAWAD,EAAAA,qBAAqBA,GAAG;AACtB,IAAA,IAAI,CAACpB,cAAc,CAACsB,eAAe,CAAC,UAAU,CAAC,CAAA;IAC/C,IAAI,CAACtB,cAAc,CAACkB,SAAS,CAACK,MAAM,CAAC,iCAAiC,CAAC,CAAA;AACzE,GAAA;AAMF,CAAA;AA5Ga3B,QAAQ,CA2GZ4B,UAAU,GAAG,iBAAiB;;;;"}