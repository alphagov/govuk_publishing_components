{"version":3,"file":"button.mjs","sources":["../../../../src/govuk/components/button/button.mjs"],"sourcesContent":["/* eslint-disable es-x/no-function-prototype-bind -- Polyfill imported */\n\nimport { mergeConfigs } from '../../common/index.mjs'\nimport { normaliseDataset } from '../../common/normalise-dataset.mjs'\nimport '../../vendor/polyfills/Event.mjs' // addEventListener, event.target normalization and DOMContentLoaded\nimport '../../vendor/polyfills/Function/prototype/bind.mjs'\n\nvar KEY_SPACE = 32\nvar DEBOUNCE_TIMEOUT_IN_SECONDS = 1\n\n/**\n * JavaScript enhancements for the Button component\n *\n * @class\n * @param {Element} $module - HTML element to use for button\n * @param {ButtonConfig} [config] - Button config\n */\nfunction Button ($module, config) {\n  if (!($module instanceof HTMLElement)) {\n    return this\n  }\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$module = $module\n\n  /** @deprecated Will be made private in v5.0 */\n  this.debounceFormSubmitTimer = null\n\n  var defaultConfig = {\n    preventDoubleClick: false\n  }\n\n  /**\n   * @deprecated Will be made private in v5.0\n   * @type {ButtonConfig}\n   */\n  this.config = mergeConfigs(\n    defaultConfig,\n    config || {},\n    normaliseDataset($module.dataset)\n  )\n}\n\n/**\n * Initialise component\n */\nButton.prototype.init = function () {\n  // Check that required elements are present\n  if (!this.$module) {\n    return\n  }\n\n  this.$module.addEventListener('keydown', this.handleKeyDown)\n  this.$module.addEventListener('click', this.debounce.bind(this))\n}\n\n/**\n * Trigger a click event when the space key is pressed\n *\n * Some screen readers tell users they can activate things with the 'button'\n * role, so we need to match the functionality of native HTML buttons\n *\n * See https://github.com/alphagov/govuk_elements/pull/272#issuecomment-233028270\n *\n * @deprecated Will be made private in v5.0\n * @param {KeyboardEvent} event - Keydown event\n */\nButton.prototype.handleKeyDown = function (event) {\n  var $target = event.target\n\n  // Handle space bar only\n  if (event.keyCode !== KEY_SPACE) {\n    return\n  }\n\n  // Handle elements with [role=\"button\"] only\n  if ($target instanceof HTMLElement && $target.getAttribute('role') === 'button') {\n    event.preventDefault() // prevent the page from scrolling\n    $target.click()\n  }\n}\n\n/**\n * Debounce double-clicks\n *\n * If the click quickly succeeds a previous click then nothing will happen. This\n * stops people accidentally causing multiple form submissions by double\n * clicking buttons.\n *\n * @deprecated Will be made private in v5.0\n * @param {MouseEvent} event - Mouse click event\n * @returns {undefined | false} Returns undefined, or false when debounced\n */\nButton.prototype.debounce = function (event) {\n  // Check the button that was clicked has preventDoubleClick enabled\n  if (!this.config.preventDoubleClick) {\n    return\n  }\n\n  // If the timer is still running, prevent the click from submitting the form\n  if (this.debounceFormSubmitTimer) {\n    event.preventDefault()\n    return false\n  }\n\n  this.debounceFormSubmitTimer = setTimeout(function () {\n    this.debounceFormSubmitTimer = null\n  }.bind(this), DEBOUNCE_TIMEOUT_IN_SECONDS * 1000)\n}\n\nexport default Button\n\n/**\n * Button config\n *\n * @typedef {object} ButtonConfig\n * @property {boolean} [preventDoubleClick = false] - Prevent accidental double\n *   clicks on submit buttons from submitting forms multiple times.\n */\n"],"names":[],"mappings":";;;;;AAAA;AACA,AAKA;AACA,IAAI,SAAS,GAAG,GAAE;AAClB,IAAI,2BAA2B,GAAG,EAAC;;;;;;;;;AASnC,SAAS,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE;EAChC,IAAI,EAAE,OAAO,YAAY,WAAW,CAAC,EAAE;IACrC,OAAO,IAAI;GACZ;;;EAGD,IAAI,CAAC,OAAO,GAAG,QAAO;;;EAGtB,IAAI,CAAC,uBAAuB,GAAG,KAAI;;EAEnC,IAAI,aAAa,GAAG;IAClB,kBAAkB,EAAE,KAAK;IAC1B;;;;;;EAMD,IAAI,CAAC,MAAM,GAAG,YAAY;IACxB,aAAa;IACb,MAAM,IAAI,EAAE;IACZ,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC;IAClC;CACF;;;;;AAKD,MAAM,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;;EAElC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;IACjB,MAAM;GACP;;EAED,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,EAAC;EAC5D,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;EACjE;;;;;;;;;;;;;AAaD,MAAM,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,KAAK,EAAE;EAChD,IAAI,OAAO,GAAG,KAAK,CAAC,OAAM;;;EAG1B,IAAI,KAAK,CAAC,OAAO,KAAK,SAAS,EAAE;IAC/B,MAAM;GACP;;;EAGD,IAAI,OAAO,YAAY,WAAW,IAAI,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,QAAQ,EAAE;IAC/E,KAAK,CAAC,cAAc,GAAE;IACtB,OAAO,CAAC,KAAK,GAAE;GAChB;EACF;;;;;;;;;;;;;AAaD,MAAM,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,KAAK,EAAE;;EAE3C,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,kBAAkB,EAAE;IACnC,MAAM;GACP;;;EAGD,IAAI,IAAI,CAAC,uBAAuB,EAAE;IAChC,KAAK,CAAC,cAAc,GAAE;IACtB,OAAO,KAAK;GACb;;EAED,IAAI,CAAC,uBAAuB,GAAG,UAAU,CAAC,YAAY;IACpD,IAAI,CAAC,uBAAuB,GAAG,KAAI;GACpC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,2BAA2B,GAAG,IAAI,EAAC;EAClD;AACD,AAEA;;;;;;;GAOG;;;;"}